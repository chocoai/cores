Calendar=function(c,e,d,f){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=d||null;this.onClose=f||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof c=="number"?c:Calendar._FD;this.showsOtherMonths=false;this.dateStr=e;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined")Calendar._SDN_len=3;for(var b=[],a=8;a>0;)b[--a]=Calendar._DN[a].substr(0,Calendar._SDN_len);Calendar._SDN=b;if(typeof Calendar._SMN_len=="undefined")Calendar._SMN_len=3;b=[];for(var a=12;a>0;)b[--a]=Calendar._MN[a].substr(0,Calendar._SMN_len);Calendar._SMN=b}};Calendar._C=null;Calendar.is_ie=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent);Calendar.is_ie5=Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent);Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(a){var e=0,f=0,c=/^div$/i.test(a.tagName);if(c&&a.scrollLeft)e=a.scrollLeft;if(c&&a.scrollTop)f=a.scrollTop;var b={x:a.offsetLeft-e,y:a.offsetTop-f};if(a.offsetParent){var d=this.getAbsolutePos(a.offsetParent);b.x+=d.x;b.y+=d.y}return b};Calendar.isRelated=function(d,b){var a=b.relatedTarget;if(!a){var c=b.type;if(c=="mouseover")a=b.fromElement;else if(c=="mouseout")a=b.toElement}while(a){if(a==d)return true;a=a.parentNode}return false};Calendar.removeClass=function(a,e){if(!(a&&a.className))return;for(var b=a.className.split(" "),c=[],d=b.length;d>0;)if(b[--d]!=e)c[c.length]=b[d];a.className=c.join(" ")};Calendar.addClass=function(b,a){Calendar.removeClass(b,a);b.className+=" "+a};Calendar.getElement=function(b){var a=Calendar.is_ie?window.event.srcElement:b.currentTarget;while(a.nodeType!=1||/^div$/i.test(a.tagName))a=a.parentNode;return a};Calendar.getTargetElement=function(b){var a=Calendar.is_ie?window.event.srcElement:b.target;while(a.nodeType!=1)a=a.parentNode;return a};Calendar.stopEvent=function(a){a||(a=window.event);if(Calendar.is_ie){a.cancelBubble=true;a.returnValue=false}else{a.preventDefault();a.stopPropagation()}return false};Calendar.addEvent=function(a,b,c){if(a.attachEvent)a.attachEvent("on"+b,c);else if(a.addEventListener)a.addEventListener(b,c,true);else a["on"+b]=c};Calendar.removeEvent=function(a,b,c){if(a.detachEvent)a.detachEvent("on"+b,c);else if(a.removeEventListener)a.removeEventListener(b,c,true);else a["on"+b]=null};Calendar.createElement=function(c,b){var a=null;if(document.createElementNS)a=document.createElementNS("http://www.w3.org/1999/xhtml",c);else a=document.createElement(c);typeof b!="undefined"&&b.appendChild(a);return a};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(a){return typeof a.month!="undefined"?a:typeof a.parentNode.month!="undefined"?a.parentNode:null};Calendar.findYear=function(a){return typeof a.year!="undefined"?a:typeof a.parentNode.year!="undefined"?a.parentNode:null};Calendar.showMonthsCombo=function(){var a=Calendar._C;if(!a)return false;var a=a,b=a.activeDiv,f=a.monthsCombo;a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite");a.activeMonth&&Calendar.removeClass(a.activeMonth,"active");var e=a.monthsCombo.getElementsByTagName("div")[a.date.getMonth()];Calendar.addClass(e,"active");a.activeMonth=e;var c=f.style;c.display="block";if(b.navtype<0)c.left=b.offsetLeft+"px";else{var d=f.offsetWidth;if(typeof d=="undefined")d=50;c.left=b.offsetLeft+b.offsetWidth-d+"px"}c.top=b.offsetTop+b.offsetHeight+"px"};Calendar.showYearsCombo=function(i){var a=Calendar._C;if(!a)return false;var a=a,b=a.activeDiv,g=a.yearsCombo;a.hilitedYear&&Calendar.removeClass(a.hilitedYear,"hilite");a.activeYear&&Calendar.removeClass(a.activeYear,"active");a.activeYear=null;for(var d=a.date.getFullYear()+(i?1:-1),c=g.firstChild,h=false,j=12;j>0;--j){if(d>=a.minYear&&d<=a.maxYear){c.innerHTML=d;c.year=d;c.style.display="block";h=true}else c.style.display="none";c=c.nextSibling;d+=i?a.yearStep:-a.yearStep}if(h){var e=g.style;e.display="block";if(b.navtype<0)e.left=b.offsetLeft+"px";else{var f=g.offsetWidth;if(typeof f=="undefined")f=50;e.left=b.offsetLeft+b.offsetWidth-f+"px"}e.top=b.offsetTop+b.offsetHeight+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal)return false;cal.timeout&&clearTimeout(cal.timeout);var b=cal.activeDiv;if(!b)return false;var c=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(b,"active");(c==b||c.parentNode==b)&&Calendar.cellClick(b,ev);var e=Calendar.findMonth(c),a=null;if(e){a=new Date(cal.date);if(e.month!=a.getMonth()){a.setMonth(e.month);cal.setDate(a);cal.dateClicked=false;cal.callHandler()}}else{var d=Calendar.findYear(c);if(d){a=new Date(cal.date);if(d.year!=a.getFullYear()){a.setFullYear(d.year);cal.setDate(a);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(g){var a=Calendar._C;if(!a)return;var b=a.activeDiv,e=Calendar.getTargetElement(g);if(e==b||e.parentNode==b){Calendar.addClass(b,"hilite active");Calendar.addClass(b.parentNode,"rowhilite")}else{(typeof b.navtype=="undefined"||b.navtype!=50&&(b.navtype==0||Math.abs(b.navtype)>2))&&Calendar.removeClass(b,"active");Calendar.removeClass(b,"hilite");Calendar.removeClass(b.parentNode,"rowhilite")}g||(g=window.event);if(b.navtype==50&&e!=b){var j=Calendar.getAbsolutePos(b),m=b.offsetWidth,k=g.clientX,f,l=true;if(k>j.x+m){f=k-j.x-m;l=false}else f=j.x-k;if(f<0)f=0;for(var d=b._range,n=b._current,p=Math.floor(f/10)%d.length,c=d.length;--c>=0;)if(d[c]==n)break;while(p-->0)if(l){if(--c<0)c=d.length-1}else if(++c>=d.length)c=0;var o=d[c];b.innerHTML=o;a.onUpdateTime()}var i=Calendar.findMonth(e);if(i)if(i.month!=a.date.getMonth()){a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite");Calendar.addClass(i,"hilite");a.hilitedMonth=i}else a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite");else{a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite");var h=Calendar.findYear(e);if(h)if(h.year!=a.date.getFullYear()){a.hilitedYear&&Calendar.removeClass(a.hilitedYear,"hilite");Calendar.addClass(h,"hilite");a.hilitedYear=h}else a.hilitedYear&&Calendar.removeClass(a.hilitedYear,"hilite");else a.hilitedYear&&Calendar.removeClass(a.hilitedYear,"hilite")}return Calendar.stopEvent(g)};Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a))return Calendar.stopEvent(a)};Calendar.calDragIt=function(d){var a=Calendar._C;if(!(a&&a.dragging))return false;var b,c;if(Calendar.is_ie){c=window.event.clientY+document.body.scrollTop;b=window.event.clientX+document.body.scrollLeft}else{b=d.pageX;c=d.pageY}a.hideShowCovered();var e=a.element.style;e.left=b-a.xOffs+"px";e.top=c-a.yOffs+"px";return Calendar.stopEvent(d)};Calendar.calDragEnd=function(ev){var a=Calendar._C;if(!a)return false;a.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}a.hideShowCovered()};Calendar.dayMouseDown=function(b){var el=Calendar.getElement(b);if(el.disabled)return false;var a=el.calendar;a.activeDiv=el;Calendar._C=a;if(el.navtype!=300)with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver);addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}else a.isPopup&&a._dragStart(b);if(el.navtype==-1||el.navtype==1){a.timeout&&clearTimeout(a.timeout);a.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else if(el.navtype==-2||el.navtype==2){a.timeout&&clearTimeout(a.timeout);a.timeout=setTimeout(el.navtype>0?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else a.timeout=null;return Calendar.stopEvent(b)};Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a),a||window.event);Calendar.is_ie&&document.selection.empty()};Calendar.dayMouseOver=function(b){var a=Calendar.getElement(b);if(Calendar.isRelated(a,b)||Calendar._C||a.disabled)return false;if(a.ttip){if(a.ttip.substr(0,1)=="_")a.ttip=a.caldate.print(a.calendar.ttDateFormat)+a.ttip.substr(1);a.calendar.tooltips.innerHTML=a.ttip}if(a.navtype!=300){Calendar.addClass(a,"hilite");a.caldate&&Calendar.addClass(a.parentNode,"rowhilite")}return Calendar.stopEvent(b)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled)return false;removeClass(el,"hilite");el.caldate&&removeClass(el.parentNode,"rowhilite");if(el.calendar)el.calendar.tooltips.innerHTML=_TT.SEL_DATE;return stopEvent(ev)}};Calendar.cellClick=function(c,l){var a=c.calendar,h=false,i=false,b=null;if(typeof c.navtype=="undefined"){if(a.currentDateEl){Calendar.removeClass(a.currentDateEl,"selected");Calendar.addClass(c,"selected");h=a.currentDateEl==c;if(!h)a.currentDateEl=c}a.date.setDateOnly(c.caldate);b=a.date;var m=!(a.dateClicked=!c.otherMonth);if(!m&&!a.currentDateEl)a._toggleMultipleDate(new Date(b));else i=!c.disabled;m&&a._init(a.firstDayOfWeek,b)}else{if(c.navtype==200){Calendar.removeClass(c,"hilite");a.callCloseHandler();return}b=new Date(a.date);c.navtype==0&&b.setDateOnly(new Date);a.dateClicked=false;var d=b.getFullYear(),k=b.getMonth();function g(c){var d=b.getDate(),a=b.getMonthDays(c);d>a&&b.setDate(a);b.setMonth(c)}switch(c.navtype){case 400:Calendar.removeClass(c,"hilite");var j=Calendar._TT.ABOUT;if(typeof j!="undefined")j+=a.showsTime?Calendar._TT.ABOUT_TIME:"";else j="";alert(j);return;case-2:d>a.minYear&&b.setFullYear(d-1);break;case-1:if(k>0)g(k-1);else if(d-->a.minYear){b.setFullYear(d);g(11)}break;case 1:if(k<11)g(k+1);else if(d<a.maxYear){b.setFullYear(d+1);g(0)}break;case 2:d<a.maxYear&&b.setFullYear(d+1);break;case 100:a.setFirstDayOfWeek(c.fdow);return;case 50:for(var f=c._range,n=c.innerHTML,e=f.length;--e>=0;)if(f[e]==n)break;if(l&&l.shiftKey){if(--e<0)e=f.length-1}else if(++e>=f.length)e=0;var o=f[e];c.innerHTML=o;a.onUpdateTime();return;case 0:if(typeof a.getDateStatus=="function"&&a.getDateStatus(b,b.getFullYear(),b.getMonth(),b.getDate()))return false}if(!b.equalsTo(a.date)){a.setDate(b);i=true}else if(c.navtype==0)i=h=true}if(i)l&&a.callHandler();if(h){Calendar.removeClass(c,"hilite");l&&a.callCloseHandler()}};Calendar.prototype.create=function(m){var j=null;if(!m){j=document.getElementsByTagName("body")[0];this.isPopup=true}else{j=m;this.isPopup=false}this.date=this.dateStr?new Date(this.dateStr):new Date;var e=Calendar.createElement("table");this.table=e;e.cellSpacing=0;e.cellPadding=0;e.calendar=this;Calendar.addEvent(e,"mousedown",Calendar.tableMouseDown);var d=Calendar.createElement("div");this.element=d;d.className="calendar";if(this.isPopup){d.style.position="absolute";d.style.display="none"}d.appendChild(e);var l=Calendar.createElement("thead",e),a=null,b=null,g=this,f=function(d,e,c){a=Calendar.createElement("td",b);a.colSpan=e;a.className="button";if(c!=0&&Math.abs(c)<=2)a.className+=" nav";Calendar._add_evs(a);a.calendar=g;a.navtype=c;a.innerHTML="<div unselectable='on'>"+d+"</div>";return a};b=Calendar.createElement("tr",l);var i=6;this.isPopup&&--i;this.weekNumbers&&++i;f("?",1,400).ttip=Calendar._TT.INFO;this.title=f("",i,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT.DRAG_TO_MOVE;this.title.style.cursor="move";f("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE}b=Calendar.createElement("tr",l);b.className="headrow";this._nav_py=f("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=f("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=f(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT.GO_TODAY;this._nav_nm=f("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=f("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;b=Calendar.createElement("tr",l);b.className="daynames";if(this.weekNumbers){a=Calendar.createElement("td",b);a.className="name wn";a.innerHTML=Calendar._TT.WK}for(var c=7;c>0;--c){a=Calendar.createElement("td",b);if(!c){a.navtype=100;a.calendar=this;Calendar._add_evs(a)}}this.firstdayname=this.weekNumbers?b.firstChild.nextSibling:b.firstChild;this._displayWeekdays();var k=Calendar.createElement("tbody",e);this.tbody=k;for(c=6;c>0;--c){b=Calendar.createElement("tr",k);if(this.weekNumbers)a=Calendar.createElement("td",b);for(var o=7;o>0;--o){a=Calendar.createElement("td",b);a.calendar=this;Calendar._add_evs(a)}}if(this.showsTime){b=Calendar.createElement("tr",k);b.className="time";a=Calendar.createElement("td",b);a.className="time";a.colSpan=2;a.innerHTML=Calendar._TT.TIME||"&nbsp;";a=Calendar.createElement("td",b);a.className="time";a.colSpan=this.weekNumbers?4:3;(function(){function e(h,i,d,f){var b=Calendar.createElement("span",a);b.className=h;b.innerHTML=i;b.calendar=g;b.ttip=Calendar._TT.TIME_PART;b.navtype=50;b._range=[];if(typeof d!="number")b._range=d;else for(var c=d;c<=f;++c){var e;if(c<10&&f>=10)e="0"+c;else e=""+c;b._range[b._range.length]=e}Calendar._add_evs(b);return b}var f=g.date.getHours(),l=g.date.getMinutes(),c=!g.time24,i=f>12;if(c&&i)f-=12;var j=e("hour",f,c?1:0,c?12:23),h=Calendar.createElement("span",a);h.innerHTML=":";h.className="colon";var k=e("minute",l,0,59),d=null;a=Calendar.createElement("td",b);a.className="time";a.colSpan=2;if(c)d=e("ampm",i?"pm":"am",["am","pm"]);else a.innerHTML="&nbsp;";g.onSetTime=function(){var e,a=this.date.getHours(),b=this.date.getMinutes();if(c){e=a>=12;if(e)a-=12;if(a==0)a=12;d.innerHTML=e?"pm":"am"}j.innerHTML=a<10?"0"+a:a;k.innerHTML=b<10?"0"+b:b};g.onUpdateTime=function(){var a=this.date,b=parseInt(j.innerHTML,10);if(c)if(/pm/i.test(d.innerHTML)&&b<12)b+=12;else if(/am/i.test(d.innerHTML)&&b==12)b=0;var e=a.getDate(),f=a.getMonth(),g=a.getFullYear();a.setHours(b);a.setMinutes(parseInt(k.innerHTML,10));a.setFullYear(g);a.setMonth(f);a.setDate(e);this.dateClicked=false;this.callHandler()}})()}else this.onSetTime=this.onUpdateTime=function(){};var p=Calendar.createElement("tfoot",e);b=Calendar.createElement("tr",p);b.className="footrow";a=f(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);a.className="ttip";if(this.isPopup){a.ttip=Calendar._TT.DRAG_TO_MOVE;a.style.cursor="move"}this.tooltips=a;d=Calendar.createElement("div",this.element);this.monthsCombo=d;d.className="combo";for(c=0;c<Calendar._MN.length;++c){var h=Calendar.createElement("div");h.className=Calendar.is_ie?"label-IEfix":"label";h.month=c;h.innerHTML=Calendar._SMN[c];d.appendChild(h)}d=Calendar.createElement("div",this.element);this.yearsCombo=d;d.className="combo";for(c=12;c>0;--c){var n=Calendar.createElement("div");n.className=Calendar.is_ie?"label-IEfix":"label";d.appendChild(n)}this._init(this.firstDayOfWeek,this.date);j.appendChild(this.element)};Calendar._keyEvent=function(g){var a=window._dynarch_popupCalendar;if(!a||a.multiple)return false;Calendar.is_ie&&(g=window.event);var f=Calendar.is_ie||g.type=="keypress",c=g.keyCode;if(g.ctrlKey)switch(c){case 37:f&&Calendar.cellClick(a._nav_pm);break;case 38:f&&Calendar.cellClick(a._nav_py);break;case 39:f&&Calendar.cellClick(a._nav_nm);break;case 40:f&&Calendar.cellClick(a._nav_ny);break;default:return false}else switch(c){case 32:Calendar.cellClick(a._nav_now);break;case 27:f&&a.callCloseHandler();break;case 37:case 38:case 39:case 40:if(f){var l,b,e,d,m,i;l=c==37||c==38;i=c==37||c==39?1:7;function h(){m=a.currentDateEl;var c=m.pos;b=c&15;e=c>>4;d=a.ar_days[e][b]}h();function k(){var b=new Date(a.date);b.setDate(b.getDate()-i);a.setDate(b)}function j(){var b=new Date(a.date);b.setDate(b.getDate()+i);a.setDate(b)}while(1){switch(c){case 37:if(--b>=0)d=a.ar_days[e][b];else{b=6;c=38;continue}break;case 38:if(--e>=0)d=a.ar_days[e][b];else{k();h()}break;case 39:if(++b<7)d=a.ar_days[e][b];else{b=0;c=40;continue}break;case 40:if(++e<a.ar_days.length)d=a.ar_days[e][b];else{j();h()}}break}if(d)if(!d.disabled)Calendar.cellClick(d);else if(l)k();else j()}break;case 13:f&&Calendar.cellClick(a.currentDateEl,g);break;default:return false}return Calendar.stopEvent(g)};Calendar.prototype._init=function(p,b){var j=new Date,x=j.getFullYear(),w=j.getMonth(),v=j.getDate();this.table.style.visibility="hidden";var c=b.getFullYear();if(c<this.minYear){c=this.minYear;b.setFullYear(c)}else if(c>this.maxYear){c=this.maxYear;b.setFullYear(c)}this.firstDayOfWeek=p;this.date=new Date(b);var e=b.getMonth(),t=b.getDate(),y=b.getMonthDays();b.setDate(1);var k=(b.getDay()-this.firstDayOfWeek)%7;if(k<0)k+=7;b.setDate(-k);b.setDate(b.getDate()+1);for(var f=this.tbody.firstChild,z=Calendar._SMN[e],q=this.ar_days=[],r=Calendar._TT.WEEKEND,o=this.multiple?(this.datesCells={}):null,g=0;g<6;++g,f=f.nextSibling){var a=f.firstChild;if(this.weekNumbers){a.className="day wn";a.innerHTML=b.getWeekNumber();a=a.nextSibling}f.className="daysrow";for(var m=false,d,s=q[g]=[],h=0;h<7;++h,a=a.nextSibling,b.setDate(d+1)){d=b.getDate();var u=b.getDay();a.className="day";a.pos=g<<4|h;s[h]=a;var l=b.getMonth()==e;if(!l)if(this.showsOtherMonths){a.className+=" othermonth";a.otherMonth=true}else{a.className="emptycell";a.innerHTML="&nbsp;";a.disabled=true;continue}else{a.otherMonth=false;m=true}a.disabled=false;a.innerHTML=this.getDateText?this.getDateText(b,d):d;if(o)o[b.print("%Y%m%d")]=a;if(this.getDateStatus){var i=this.getDateStatus(b,c,e,d);if(this.getDateToolTip){var n=this.getDateToolTip(b,c,e,d);if(n)a.title=n}if(i===true){a.className+=" disabled";a.disabled=true}else{if(/disabled/i.test(i))a.disabled=true;a.className+=" "+i}}if(!a.disabled){a.caldate=new Date(b);a.ttip="_";if(!this.multiple&&l&&d==t&&this.hiliteToday){a.className+=" selected";this.currentDateEl=a}if(b.getFullYear()==x&&b.getMonth()==w&&d==v){a.className+=" today";a.ttip+=Calendar._TT.PART_TODAY}if(r.indexOf(u.toString())!=-1)a.className+=a.otherMonth?" oweekend":" weekend"}}if(!(m||this.showsOtherMonths))f.className="emptyrow"}this.title.innerHTML=Calendar._MN[e]+", "+c;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple)for(var b in this.multiple){var a=this.datesCells[b],c=this.multiple[b];if(!c)continue;if(a)a.className+=" selected"}};Calendar.prototype._toggleMultipleDate=function(c){if(this.multiple){var a=c.print("%Y%m%d"),b=this.datesCells[a];if(b){var d=this.multiple[a];if(!d){Calendar.addClass(b,"selected");this.multiple[a]=c}else{Calendar.removeClass(b,"selected");delete this.multiple[a]}}}};Calendar.prototype.setDateToolTipHandler=function(a){this.getDateToolTip=a};Calendar.prototype.setDate=function(a){!a.equalsTo(this.date)&&this._init(this.firstDayOfWeek,a)};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(a){this._init(a,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(a){this.getDateStatus=a};Calendar.prototype.setRange=function(a,b){this.minYear=a;this.maxYear=b};Calendar.prototype.callHandler=function(){if(this.onSelected)this.onSelected(this,this.date.print(this.dateFormat))};Calendar.prototype.callCloseHandler=function(){if(this.onClose)this.onClose(this);this.hideShowCovered()};Calendar.prototype.destroy=function(){var a=this.element.parentNode;a.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(b){var a=this.element;a.parentNode.removeChild(a);b.appendChild(a)};Calendar._checkCalendar=function(b){var c=window._dynarch_popupCalendar;if(!c)return false;for(var a=Calendar.is_ie?Calendar.getElement(b):Calendar.getTargetElement(b);a!=null&&a!=c.element;a=a.parentNode);if(a==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(b)}};Calendar.prototype.show=function(){for(var c=this.table.getElementsByTagName("tr"),e=c.length;e>0;){var d=c[--e];Calendar.removeClass(d,"rowhilite");for(var a=d.getElementsByTagName("td"),f=a.length;f>0;){var b=a[--f];Calendar.removeClass(b,"hilite");Calendar.removeClass(b,"active")}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}this.hideShowCovered()};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}this.element.style.display="none";this.hidden=true;this.hideShowCovered()};Calendar.prototype.showAt=function(b,c){var a=this.element.style;a.left=b-210+"px";a.top=c+7+"px";this.show()};Calendar.prototype.showAtElement=function(b,c){var d=this,a=Calendar.getAbsolutePos(b);if(!c||typeof c!="string"){this.showAt(a.x,a.y+b.offsetHeight);return true}function e(a){if(a.x<0)a.x=0;if(a.y<0)a.y=0;var e=document.createElement("div"),d=e.style;d.position="absolute";d.right=d.bottom=d.width=d.height="0px";document.body.appendChild(e);var b=Calendar.getAbsolutePos(e);document.body.removeChild(e);if(Calendar.is_ie){b.y+=document.body.scrollTop;b.x+=document.body.scrollLeft}else{b.y+=window.scrollY;b.x+=window.scrollX}var c=a.x+a.width-b.x;if(c>0)a.x-=c;c=a.y+a.height-b.y;if(c>0)a.y-=c}this.element.style.display="block";Calendar.continuation_for_the_fucking_khtml_browser=function(){var g=d.element.offsetWidth,f=d.element.offsetHeight;d.element.style.display="none";var i=c.substr(0,1),h="l";if(c.length>1)h=c.substr(1,1);switch(i){case"T":a.y-=f;break;case"B":a.y+=b.offsetHeight;break;case"C":a.y+=(b.offsetHeight-f)/2;break;case"t":a.y+=b.offsetHeight-f}switch(h){case"L":a.x-=g;break;case"R":a.x+=b.offsetWidth;break;case"C":a.x+=(b.offsetWidth-g)/2;break;case"l":a.x+=b.offsetWidth-g}a.width=g;a.height=f+40;d.monthsCombo.style.display="none";e(a);d.showAt(a.x,a.y)};if(Calendar.is_khtml)setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10);else Calendar.continuation_for_the_fucking_khtml_browser()};Calendar.prototype.setDateFormat=function(a){this.dateFormat=a};Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a};Calendar.prototype.parseDate=function(b,a){if(!a)a=this.dateFormat;this.setDate(Date.parseDate(b,a))};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera)return;function d(b){var a=b.style.visibility;if(!a)if(document.defaultView&&typeof document.defaultView.getComputedStyle=="function")if(!Calendar.is_khtml)a=document.defaultView.getComputedStyle(b,"").getPropertyValue("visibility");else a="";else if(b.currentStyle)a=b.currentStyle.visibility;else a="";return a}for(var e=["applet","iframe","select"],c=this.element,b=Calendar.getAbsolutePos(c),h=b.x,o=c.offsetWidth+h,i=b.y,p=c.offsetHeight+i,l=e.length;l>0;)for(var j=document.getElementsByTagName(e[--l]),a=null,k=j.length;k>0;){a=j[--k];b=Calendar.getAbsolutePos(a);var f=b.x,m=a.offsetWidth+f,g=b.y,n=a.offsetHeight+g;if(this.hidden||f>o||m<h||g>p||n<i){if(!a.__msh_save_visibility)a.__msh_save_visibility=d(a);a.style.visibility=a.__msh_save_visibility}else{if(!a.__msh_save_visibility)a.__msh_save_visibility=d(a);a.style.visibility="hidden"}}};Calendar.prototype._displayWeekdays=function(){for(var d=this.firstDayOfWeek,a=this.firstdayname,e=Calendar._TT.WEEKEND,b=0;b<7;++b){a.className="day name";var c=(b+d)%7;if(b){a.ttip=Calendar._TT.DAY_FIRST.replace("%s",Calendar._DN[c]);a.navtype=100;a.calendar=this;a.fdow=c;Calendar._add_evs(a)}e.indexOf(c.toString())!=-1&&Calendar.addClass(a,"weekend");a.innerHTML=Calendar._SDN[(b+d)%7];a=a.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(c){if(this.dragging)return;this.dragging=true;var a,b;if(Calendar.is_ie){b=window.event.clientY+document.body.scrollTop;a=window.event.clientX+document.body.scrollLeft}else{b=c.clientY+window.scrollY;a=c.clientX+window.scrollX}var d=this.element.style;this.xOffs=a-parseInt(d.left);this.yOffs=b-parseInt(d.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=[31,28,31,30,31,30,31,31,30,31,30,31];Date.SECOND=1e3;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(l,k){for(var h=new Date,c=0,d=-1,e=0,b=l.split(/\W+/),m=k.match(/%./g),a=0,f=0,g=0,i=0,a=0;a<b.length;++a){if(!b[a])continue;switch(m[a]){case"%d":case"%e":e=parseInt(b[a],10);break;case"%m":d=parseInt(b[a],10)-1;break;case"%Y":case"%y":c=parseInt(b[a],10);c<100&&(c+=c>29?1900:2e3);break;case"%b":case"%B":for(f=0;f<12;++f)if(Calendar._MN[f].substr(0,b[a].length).toLowerCase()==b[a].toLowerCase()){d=f;break}break;case"%H":case"%I":case"%k":case"%l":g=parseInt(b[a],10);break;case"%P":case"%p":if(/pm/i.test(b[a])&&g<12)g+=12;else if(/am/i.test(b[a])&&g>=12)g-=12;break;case"%M":i=parseInt(b[a],10)}}if(isNaN(c))c=h.getFullYear();if(isNaN(d))d=h.getMonth();if(isNaN(e))e=h.getDate();if(isNaN(g))g=h.getHours();if(isNaN(i))i=h.getMinutes();if(c!=0&&d!=-1&&e!=0)return new Date(c,d,e,g,i,0);c=0;d=-1;e=0;for(a=0;a<b.length;++a)if(b[a].search(/[a-zA-Z]+/)!=-1){var j=-1;for(f=0;f<12;++f)if(Calendar._MN[f].substr(0,b[a].length).toLowerCase()==b[a].toLowerCase()){j=f;break}if(j!=-1){if(d!=-1)e=d+1;d=j}}else if(parseInt(b[a],10)<=12&&d==-1)d=b[a]-1;else if(parseInt(b[a],10)>31&&c==0){c=parseInt(b[a],10);c<100&&(c+=c>29?1900:2e3)}else if(e==0)e=b[a];if(c==0)c=h.getFullYear();return d!=-1&&e!=0?new Date(c,d,e,g,i,0):h};Date.prototype.getMonthDays=function(a){var b=this.getFullYear();if(typeof a=="undefined")a=this.getMonth();return 0==b%4&&(0!=b%100||0==b%400)&&a==1?29:Date._MD[a]};Date.prototype.getDayOfYear=function(){var c=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),a=new Date(this.getFullYear(),0,0,0,0,0),b=c-a;return Math.floor(b/Date.DAY)};Date.prototype.getWeekNumber=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=a.getDay();a.setDate(a.getDate()-(b+6)%7+3);var c=a.valueOf();a.setMonth(0);a.setDate(4);return Math.round((c-a.valueOf())/(7*8.64e7))+1};Date.prototype.equalsTo=function(a){return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()&&this.getHours()==a.getHours()&&this.getMinutes()==a.getMinutes()};Date.prototype.setDateOnly=function(b){var a=new Date(b);this.setDate(1);this.setFullYear(a.getFullYear());this.setMonth(a.getMonth());this.setDate(a.getDate())};Date.prototype.print=function(d){var f=this.getMonth(),h=this.getDate(),p=this.getFullYear(),n=this.getWeekNumber(),j=this.getDay(),a={},b=this.getHours(),m=b>=12,c=m?b-12:b,e=this.getDayOfYear();if(c==0)c=12;var k=this.getMinutes(),l=this.getSeconds();a["%a"]=Calendar._SDN[j];a["%A"]=Calendar._DN[j];a["%b"]=Calendar._SMN[f];a["%B"]=Calendar._MN[f];a["%C"]=1+Math.floor(p/100);a["%d"]=h<10?"0"+h:h;a["%e"]=h;a["%H"]=b<10?"0"+b:b;a["%I"]=c<10?"0"+c:c;a["%j"]=e<100?e<10?"00"+e:"0"+e:e;a["%k"]=b;a["%l"]=c;a["%m"]=f<9?"0"+(1+f):1+f;a["%M"]=k<10?"0"+k:k;a["%n"]="\n";a["%p"]=m?"PM":"AM";a["%P"]=m?"pm":"am";a["%s"]=Math.floor(this.getTime()/1e3);a["%S"]=l<10?"0"+l:l;a["%t"]="\t";a["%U"]=a["%W"]=a["%V"]=n<10?"0"+n:n;a["%u"]=j+1;a["%w"]=j;a["%y"]=(""+p).substr(2,2);a["%Y"]=p;a["%%"]="%";var g=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml)return d.replace(g,function(b){return a[b]||b});for(var o=d.match(g),i=0;i<o.length;i++){var q=a[o[i]];if(q){g=new RegExp(o[i],"g");d=d.replace(g,q)}}return d};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(b){var a=new Date(this);a.__msh_oldSetFullYear(b);a.getMonth()!=this.getMonth()&&this.setDate(28);this.__msh_oldSetFullYear(b)};window._dynarch_popupCalendar=null